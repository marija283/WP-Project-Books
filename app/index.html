<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="/images/favicon.ico" sizes="16x16 32x32 48x48 64x64"
        type="image/vnd.microsoft.icon">
   

  <title>Book project</title>

  <!-- Concatenated CSS -->
  <link href="dest/lib.css?rev=ce521111498417454cb372b05cbd5f4d" rel="stylesheet">
  <link href="dest/app.css?rev=8e97fa1199627f7f2b00ad4b41a1410e" rel="stylesheet">
  <link href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">


  <!-- za jQuery UI STAVENI-->

  <link rel="stylesheet" href="jQueryUI/jquery-ui.min.css">
  


  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

<body ng-app="book-project" ng-cloak class="ng-cloak" ng-controller="headerCtrl">
  
<div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" ui-sref="home">Application name</a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a ui-sref="home">Home</a></li>
                    <li><a ui-sref="user">UserProfile</a></li>
                     <li><a ui-sref="allBooks">Books</a></li>
                    <li><a ui-sref="visitUser({userId:1})" >VisitUser</a></li>
                </ul>
                <div class="col-sm-3 col-md-3">
                    <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search"  id="autocomplete" name="q">
                        <div class="input-group-btn">
                            <button class="btn btn-default " ng-click="searchUser()"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                    </form>
                </div>
                <ul class="nav navbar-nav navbar-right">
                    <li><a ng-hide="loggedIn" ui-sref="register" id="registerLink">Register</a></li>
                    <li><a ng-hide="loggedIn" ui-sref="login" id="loginLink">Log in</a></li>
                    <li><a ng-show="loggedIn" ui-sref="user" id="profileLink">My profile</a></li>
                    <li><a ng-show="loggedIn" ui-sref="logout" id="logOutLink">Log out</a></li>
                </ul>

            </div>
        </div>
    </div>
    <div class="container body-content">
        <!--views-->
        <br>
        <br>
        
       <div ui-view class="container slide" style="padding-top: 20px;">
       
                
            
        </div>
        
        
        <!--footer-->
    <div class="clearfix"></div>
        <hr />
        <footer>
            <p>&copy; 2016 - Book Project</p>
            
        </footer>
    </div>





<!-- Concatenated libraries -->
<script src="dest/lib.js?rev=3c1d829471c504686588fa5118ab61c1"></script>
<!-- Concatenated application -->

<script src="dest/src.js?rev=6fd83b8eaa57c84ea2f2e03ff4bfffdd"></script>

<!-- All html templates -->
<script src="dest/templates.js?rev=727a5ebf51c1cd5b765f4e7496b8225b"></script>


<!-- za jQuery UI STAVENI-->
<script src="jQueryUI/jquery.js"></script>
  <script src="jQueryUI/jquery-ui.min.js"></script>

 <script src="bower_components/react/react.js"></script>
<script src="bower_components/react/react-dom.js"></script>
<script src="bower_components/ngReact/ngReact.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>

  


  


</body>



<div>

    <div id="contentReact"></div>
    <!-- <script type="text/babel" src="src/helloworld.js"></script> -->
    <style type="text/css">
      .comment{
        border:1px solid black;
        border-radius: 10px;
        overflow: auto;
        word-wrap: break-word;
        margin-bottom: 20px;
        background-color: #EDFAFD;
      }
      .comment img{
        display:block;
        float:left;
        width:100px;
        height:100px;
        margin-right: 50px;
        margin-bottom: 10px;
      }
      .commentList{
        background-color: #E9DCCD;
        padding:20px;
      }
      .commentForm textarea{
        width:300px;
        height:150px;
      }
      .commentForm #author{
        font-size: 1.5em;
        font-weight: bold;
      }
    </style>

    <script type="text/babel" >
    
      console.log("HELLO");

      var Comment = React.createClass({
        render: function() {
          return (
              <div className="comment">
                <div>
                  <img className="img-resposnive img-circle" src={this.props.allInfo.image}/>
                  <h2 className="commentAuthor">
                    {this.props.author}
                  </h2>
                </div>            
                {this.props.children}
              </div>
            );
        }
      });

      var CommentList = React.createClass({
        render: function() {
          var commentNodes = this.props.data.map(function(comment){
            return (
                <Comment author={comment.author} allInfo={comment} key={comment.id}>{comment.text}</Comment>
              );
          });
          return (
              <div className="commentList">
                    {commentNodes}
                 </div>
            );
        }
      });

      var CommentForm  = React.createClass({
        getInitialState: function() {
            return {author: '', text: ''};
          },
        handleTextChange: function(e) {
            this.setState({text: e.target.value});
        },
        handleSubmit: function(e) {
            e.preventDefault();
            var author = $("#author").text();
            var text = this.state.text.trim();
            if (!text || !author) {
              return;
            }
            this.props.onCommentSubmit({author: author, text: text});
            this.setState({author: '', text: ''});
        },
        render: function() {
          return (
              <form className="commentForm" onSubmit={this.handleSubmit}>
                   Write comment as: <span id="author"> Riste Poposki </span> 
                   
                    <textarea type="text" placeholder="Say something..." value={this.state.text} onChange={this.handleTextChange} />
                     
                    <input className="btn btn-success" type="submit" value="Post" />
                  </form>
            );
        }
      });

      var CommentBox = React.createClass({
        getInitialState: function() {
            return {data: []};
          },
          componentDidMount: function() {

            $.ajax({
              url: this.props.url,
              dataType: 'json',
              cache: false,
              success: function(data) {
                var AllComments=[];
                $(data).each(function(index,item){
                  var comment={};
                  comment.id = item.id;
                  comment.author = item.userFrom.fname +" "+item.userFrom.lname;
                  comment.text = item.comment;
                  comment.image = "http://localhost:8080/book-project/api/users/get-image/"+item.userFrom.id;
                  //console.log(comment)
                  AllComments.push(comment);
                });
                this.setState({data: AllComments});

              }.bind(this),
              error: function(xhr, status, err) {
                console.error(this.props.url, status, err.toString());
              }.bind(this)
            });
          },

          handleCommentSubmit: function(comment) {
              var data = this.state.data;
              data.push(comment);
              this.setState({data: data});
          },
        render: function () {
          return (
              <div>
                <h1>Comments</h1>
                    <CommentList data={this.state.data} />
                    <CommentForm onCommentSubmit={this.handleCommentSubmit} />
                  </div>
            );
        }
      });

      ReactDOM.render(
        <CommentBox url="http://localhost:8080/book-project/api/comments/of-user/1"/>,
        document.getElementById('contentReact')
      );
    </script> 




</div>
</html>
